概要: LangChain 1.0監視プロトタイプ (Deep Research Agent)

プロジェクト目的: `langgraph`をベースにしたエージェント・アーキテクチャを習得し、複雑なエージェントの動作をLangSmithでトレース（追跡）およびデバッグする手法を確立する。最終的には、ユーザーのクエリに対して、自律的に深い調査を行い、参照情報付きの高品質なレポートを生成する「Deep Research Agent」を構築する。

📍 フェーズ1: 最小実行グラフとLangSmith監視 (完了)

*   最もシンプルな「単一ノード」または「複数ノードの直線的な連携」を構築し、その動作をLangSmithで監視する。

📍 フェーズ2: 役割ベースの直線的なワークフロー (完了)

*   `Planner`, `Searcher`, `Analyzer`, `Synthesizer` の役割を持つノードを定義し、直線的なワークフローを構築する。

📍 フェーズ3: 自律的な深掘りループ

*   `Analyzer` の後に、分析結果が十分かどうかを評価する「`Evaluator`」ノードを追加する。
*   `add_conditional_edges` を使用し、評価結果に応じて `Synthesizer` に進むか、`Planner` に戻って計画を修正し、再度検索させるループを実装する。
*   ループの際に、`search_results` や `analyzed_data` が蓄積されていくように状態を更新する。

📍 フェーズ4: ユーザーによる計画の確認

*   `Planner` が計画を立案した後、一度ユーザーに計画を提示し、実行の確認を求める。
*   ユーザーが承認した場合のみ、深掘りループ（フェーズ3）を実行する。

📍 フェーズ5: 高品質なレポートと参照リスト

*   `Synthesizer` ノードを改良し、より構造化された「美しい」レポートを生成する。
*   レポートには、調査中に使用した情報源（URLなど）を「参照リスト」として含める。
